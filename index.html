<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MÃ©MÃ©d â€” GÃ©nÃ©rateur de noms de projets IHECS</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;700;800&family=Barlow:wght@400;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --red: #CC1122;
  --red-dark: #aa0d1c;
  --bg: #0d0d0d;
  --surface: #161616;
  --surface2: #1e1e1e;
  --border: #2a2a2a;
  --text: #f0ede8;
  --muted: #777;
  --muted2: #444;
}

body {
  background: var(--bg);
  color: var(--text);
  font-family: 'Barlow', sans-serif;
  min-height: 100vh;
  line-height: 1.5;
}

/* â”€â”€ HEADER â”€â”€ */
header {
  border-bottom: 1px solid var(--border);
  padding: 20px 48px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  background: rgba(13,13,13,0.95);
  backdrop-filter: blur(8px);
  z-index: 100;
}

.logo {
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 22px;
  font-weight: 800;
  letter-spacing: 0.12em;
  text-transform: uppercase;
}
.logo em { color: var(--red); font-style: normal; }

.header-meta {
  font-size: 12px;
  color: var(--muted);
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

/* â”€â”€ MAIN â”€â”€ */
main {
  max-width: 900px;
  margin: 0 auto;
  padding: 56px 48px 80px;
}

/* â”€â”€ INTRO â”€â”€ */
.intro {
  margin-bottom: 56px;
  display: flex;
  align-items: flex-start;
  gap: 32px;
}
.intro-bar { width: 4px; background: var(--red); flex-shrink: 0; align-self: stretch; }
.intro-text h1 {
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 38px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  line-height: 1.1;
  margin-bottom: 10px;
}
.intro-text p { color: var(--muted); font-size: 14px; max-width: 660px; }

/* â”€â”€ INPUT SECTION â”€â”€ */
.input-section {
  margin-bottom: 48px;
  border: 1px solid var(--border);
  border-radius: 3px;
  overflow: hidden;
}

.input-header {
  background: var(--surface);
  padding: 18px 32px;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  gap: 16px;
}

.input-pill {
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--red);
  border: 1px solid var(--red);
  padding: 5px 14px;
  white-space: nowrap;
}

.input-title {
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 20px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

.input-body { padding: 32px; }

label {
  display: block;
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  color: var(--muted);
  margin-bottom: 10px;
}

textarea {
  width: 100%;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 2px;
  color: var(--text);
  font-family: 'Barlow', sans-serif;
  font-size: 14px;
  padding: 16px;
  resize: vertical;
  transition: border-color 0.2s;
  line-height: 1.6;
  min-height: 120px;
}
textarea:focus {
  outline: none;
  border-color: var(--red);
}
textarea::placeholder { color: var(--muted2); }

.hint {
  margin-top: 8px;
  font-size: 11px;
  color: var(--muted2);
  font-style: italic;
}

.btn-generate {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  width: 100%;
  margin-top: 24px;
  padding: 18px 40px;
  background: var(--red);
  color: white;
  border: none;
  border-radius: 2px;
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 18px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-generate:hover { background: var(--red-dark); }
.btn-generate:active { transform: scale(0.98); }
.btn-generate:disabled {
  background: var(--muted2);
  cursor: not-allowed;
  transform: none;
}

/* â”€â”€ WHEEL SECTION â”€â”€ */
.wheel-section {
  display: none;
  flex-direction: column;
  align-items: center;
  gap: 32px;
  margin-bottom: 48px;
}
.wheel-section.visible {
  display: flex;
}

.wheel-container {
  position: relative;
  width: 460px;
  height: 460px;
}

#wheel {
  display: block;
  width: 460px;
  height: 460px;
  filter: drop-shadow(0 8px 32px rgba(0,0,0,0.5));
}

.wheel-pointer {
  position: absolute;
  top: -18px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 18px solid transparent;
  border-right: 18px solid transparent;
  border-top: 36px solid var(--red);
  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.4));
  z-index: 10;
}

.btn-spin {
  padding: 16px 56px;
  background: var(--text);
  color: var(--bg);
  border: none;
  border-radius: 2px;
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 16px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-spin:hover { background: var(--red); color: white; }
.btn-spin:disabled {
  background: var(--muted2);
  color: var(--muted);
  cursor: not-allowed;
}

/* â”€â”€ RESULT â”€â”€ */
.result-section {
  display: none;
  text-align: center;
  padding: 48px 32px;
  border: 1px solid var(--border);
  border-radius: 3px;
  background: var(--surface);
  margin-bottom: 48px;
}
.result-section.visible { display: block; }

.result-label {
  font-size: 12px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.12em;
  margin-bottom: 20px;
}

.result-name {
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 52px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  line-height: 1.1;
  color: var(--red);
  margin-bottom: 24px;
  animation: resultPop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes resultPop {
  from { transform: scale(0.5); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.result-actions {
  display: flex;
  gap: 12px;
  justify-content: center;
  flex-wrap: wrap;
  margin-top: 24px;
}

.btn-action {
  padding: 12px 28px;
  border: 1px solid var(--border);
  border-radius: 2px;
  background: transparent;
  color: var(--text);
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 14px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-action:hover { border-color: var(--red); color: var(--red); }

/* â”€â”€ ALL NAMES LIST â”€â”€ */
.all-names {
  display: none;
  border: 1px solid var(--border);
  border-radius: 3px;
  overflow: hidden;
  margin-bottom: 48px;
}
.all-names.visible { display: block; }

.all-names-header {
  background: var(--surface);
  padding: 14px 32px;
  border-bottom: 1px solid var(--border);
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 14px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--muted);
}

.all-names-list {
  padding: 20px 32px;
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.name-chip {
  padding: 10px 16px;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 2px;
  font-family: 'Barlow Condensed', sans-serif;
  font-size: 16px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  cursor: pointer;
  transition: all 0.2s;
  text-align: center;
}
.name-chip:hover {
  border-color: var(--red);
  color: var(--red);
}
.name-chip.winner {
  border-color: var(--red);
  background: rgba(204,17,34,0.1);
  color: var(--red);
}

/* â”€â”€ FOOTER â”€â”€ */
.footer {
  text-align: center;
  padding-top: 48px;
  border-top: 1px solid var(--border);
  font-size: 12px;
  color: var(--muted2);
}
.footer a { color: var(--muted); text-decoration: none; }
.footer a:hover { color: var(--red); }

/* â”€â”€ RESPONSIVE â”€â”€ */
@media (max-width: 600px) {
  main { padding: 32px 16px 64px; }
  header { padding: 16px 20px; }
  .intro { flex-direction: column; gap: 16px; }
  .intro-bar { width: 100%; height: 4px; }
  .wheel-container, #wheel { width: 320px; height: 320px; }
  .result-name { font-size: 36px; }
  .all-names-list { grid-template-columns: 1fr; }
  .header-meta { display: none; }
}
</style>
</head>
<body>

<header>
  <div class="logo">MÃ©<em>MÃ©d</em></div>
  <div class="header-meta">GÃ©nÃ©rateur de noms Â· Projets IHECS</div>
</header>

<main>
  <div class="intro">
    <div class="intro-bar"></div>
    <div class="intro-text">
      <h1>Trouvez le nom de votre projet</h1>
      <p>DÃ©crivez votre projet en quelques phrases, lancez la roue et dÃ©couvrez des propositions de noms percutants, inspirÃ©s du style IHECS : jeux de mots, dÃ©tournements d'expressions, portmanteaux et punchlines journalistiques.</p>
    </div>
  </div>

  <!-- â”€â”€ INPUT â”€â”€ -->
  <div class="input-section">
    <div class="input-header">
      <span class="input-pill">Ã‰tape 01</span>
      <span class="input-title">DÃ©crivez votre projet</span>
    </div>
    <div class="input-body">
      <label for="description">De quoi parle votre projet ?</label>
      <textarea id="description" placeholder="Ex : Notre projet explore la prÃ©caritÃ© alimentaire chez les Ã©tudiants universitaires en Belgique. On veut montrer comment les jeunes jonglent entre Ã©tudes et survie, entre resto U et banques alimentairesâ€¦"></textarea>
      <p class="hint">Plus votre description est prÃ©cise, plus les noms proposÃ©s seront pertinents. Mentionnez le sujet, l'angle, le public concernÃ©.</p>
      <button class="btn-generate" id="btn-generate" onclick="generate()">
        <span>âŸ³</span> GÃ©nÃ©rer des noms
      </button>
    </div>
  </div>

  <!-- â”€â”€ WHEEL â”€â”€ -->
  <div class="wheel-section" id="wheel-section">
    <div class="wheel-container">
      <div class="wheel-pointer"></div>
      <canvas id="wheel" width="920" height="920"></canvas>
    </div>
    <button class="btn-spin" id="btn-spin" onclick="spinWheel()">Lancer la roue</button>
  </div>

  <!-- â”€â”€ RESULT â”€â”€ -->
  <div class="result-section" id="result-section">
    <div class="result-label">âœ¦ Le nom de votre projet âœ¦</div>
    <div class="result-name" id="result-name"></div>
    <div class="result-actions">
      <button class="btn-action" onclick="copyName()">ðŸ“‹ Copier</button>
      <button class="btn-action" onclick="spinWheel()">âŸ³ Relancer la roue</button>
      <button class="btn-action" onclick="generate()">â™» Nouveaux noms</button>
    </div>
  </div>

  <!-- â”€â”€ ALL NAMES â”€â”€ -->
  <div class="all-names" id="all-names">
    <div class="all-names-header">Toutes les propositions</div>
    <div class="all-names-list" id="all-names-list"></div>
  </div>

  <div class="footer">
    <p>InspirÃ© des projets <a href="https://fund.ihecs.be/fr-FR/projects" target="_blank">IHECS Fund</a> Â· Outil pÃ©dagogique</p>
  </div>
</main>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// STOP WORDS & THEME DETECTION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const STOP_WORDS = new Set([
  'le','la','les','un','une','des','du','de','d','l','au','aux','ce','ces','cette',
  'mon','ma','mes','ton','ta','tes','son','sa','ses','notre','nos','votre','vos','leur','leurs',
  'je','tu','il','elle','on','nous','vous','ils','elles','me','te','se',
  'et','ou','mais','donc','ni','car','que','qui','quoi','dont','oÃ¹',
  'dans','en','sur','sous','par','pour','avec','sans','chez','entre','vers','depuis',
  'est','sont','a','ont','fait','faire','Ãªtre','avoir','Ã©tÃ©','Ã©tait','peut','doit',
  'plus','moins','trÃ¨s','aussi','bien','mal','tout','tous','toute','toutes',
  'pas','ne','n','y','c','s','qu','j',
  'comment','pourquoi','quand','comme',
  'projet','notre','veut','montrer','explorer','enquÃªte','sujet','angle'
]);

const THEMES = {
  environnement: ['climat','pollution','nature','eau','forÃªt','biodiversitÃ©','Ã©nergie','nuclÃ©aire','recyclage','dÃ©chets','carbone','Ã©cologie','planÃ¨te','terre','vert','durable','animal','faune','flore','ocÃ©an','mer','air','pesticide','agriculture','bio'],
  social: ['inÃ©galitÃ©','pauvretÃ©','logement','migration','rÃ©fugiÃ©','sans-abri','prÃ©caritÃ©','solidaritÃ©','exclusion','discrimination','racisme','minoritÃ©','intÃ©gration','communautÃ©','quartier','banlieue','classe','riche','pauvre','marginal','isolement','solitude'],
  alimentation: ['alimentaire','nourriture','manger','faim','restaurant','cuisine','bio','agriculture','pesticide','fast-food','obÃ©sitÃ©','rÃ©gime','vegan','viande','supermarchÃ©','gaspillage'],
  santÃ©: ['santÃ©','mental','hÃ´pital','mÃ©decin','maladie','psychologie','dÃ©pression','addiction','drogue','alcool','bien-Ãªtre','burn','stress','anxiÃ©tÃ©','thÃ©rapie','soin','patient','euthanasie','handicap','autisme'],
  justice: ['justice','prison','tribunal','droit','loi','crime','police','avocat','verdict','dÃ©tenu','procÃ¨s','victime','criminel','dÃ©linquance','garde','pÃ©nal','judiciaire','innocent','coupable'],
  mÃ©dias: ['mÃ©dia','journalisme','presse','information','fake','rÃ©seau','social','influenceur','podcast','radio','tÃ©lÃ©vision','algorithme','propagande','censure','libertÃ©','expression','image','Ã©cran','viral','buzz','tiktok','instagram','youtube'],
  culture: ['art','musique','cinÃ©ma','thÃ©Ã¢tre','livre','danse','mode','design','photographie','patrimoine','musÃ©e','festival','hip-hop','rap','street','graffiti','urbain','tradition','identitÃ©','langue','folklore'],
  Ã©ducation: ['Ã©cole','universitÃ©','Ã©tudiant','enseignement','formation','diplÃ´me','apprentissage','jeune','adolescent','jeunesse','campus','bourse','dÃ©crochage','orientation','stage','Ã©tudes'],
  sport: ['sport','football','athlÃ¨te','compÃ©tition','dopage','supporter','match','olympique','boxe','basket','tennis','rugby','performance','club','entraÃ®neur','stade','champion','dÃ©faite'],
  technologie: ['technologie','numÃ©rique','intelligence','artificielle','donnÃ©es','algorithme','robot','cyber','startup','application','smartphone','internet','hacker','sÃ©curitÃ©','surveillance','camÃ©ra','reconnaissance'],
  politique: ['politique','dÃ©mocratie','Ã©lection','gouvernement','parti','vote','parlement','pouvoir','militant','activisme','protestation','manifestation','rÃ©volution','corruption','lobby','populisme','extrÃªme'],
  genre: ['genre','fÃ©minisme','femme','homme','sexisme','Ã©galitÃ©','lgbtq','queer','transgenre','sexualitÃ©','harcÃ¨lement','patriarcat','masculinitÃ©','intime','conjugal','couple','mariage'],
  international: ['guerre','conflit','paix','rÃ©fugiÃ©','frontiÃ¨re','international','gÃ©opolitique','diplomatie','humanitaire','ong','terrorisme','armÃ©e','militaire','bombe','occupation','colonialisme','diaspora'],
  Ã©conomie: ['Ã©conomie','travail','emploi','chÃ´mage','salaire','entreprise','capitalisme','finance','banque','dette','impÃ´t','grÃ¨ve','syndicat','uber','prÃ©caritÃ©','inflation','crise'],
  urbanisme: ['ville','urbain','quartier','banlieue','gentrification','immobilier','transport','mobilitÃ©','vÃ©lo','voiture','mÃ©tro','trafic','logement','bÃ©ton','architecture','espace','public']
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAME GENERATION ENGINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Templates that adapt to keywords
function getTemplates(keywords) {
  const kw = keywords.slice(0, 5);
  const cap = w => w.charAt(0).toUpperCase() + w.slice(1);
  const results = [];

  for (const w of kw) {
    const cw = cap(w);
    results.push(
      `${cw} en sursis`,
      `${cw} sous tension`,
      `L'envers du ${w}`,
      `${cw}s perdus`,
      `Contre-${w}`,
      `${cw} Ã  vif`,
      `${cw}, off the record`,
      `Les voix du ${w}`,
      `${cw} Ã  dÃ©couvert`,
      `${cw} en eaux troubles`,
      `Hors ${w}`,
      `${cw} mode d'emploi`,
      `Au cÅ“ur du ${w}`,
      `${cw} sans filtre`,
      `DerriÃ¨re le ${w}`,
      `${cw} Ã  huis clos`
    );
  }

  // Combination templates (2 keywords)
  if (kw.length >= 2) {
    for (let i = 0; i < kw.length - 1; i++) {
      for (let j = i + 1; j < kw.length; j++) {
        const a = cap(kw[i]), b = cap(kw[j]);
        results.push(
          `${a} & ${b}`,
          `De ${kw[i]} en ${kw[j]}`,
          `${a} contre ${b}`,
          `Entre ${kw[i]} et ${kw[j]}`
        );
      }
    }
  }

  return results;
}

// French expression twists â€” the core IHECS naming style
const EXPRESSION_TWISTS = {
  environnement: [
    'Vert de rage','Terre promise, terre perdue','L\'Effet de serre','En terrain minÃ©',
    'Courant d\'air','Le Prix du vert','Nature morte','Racines profondes',
    'Eaux vives','Le Chant des forÃªts','Sous la canopÃ©e','Dernier souffle',
    'Soleil noir','Le Grand dÃ©gel','Graines de colÃ¨re','MarÃ©e haute',
    'DÃ©bordements','L\'Heure verte','Cendres fertiles','Le Monde d\'aprÃ¨s'
  ],
  social: [
    'Ceux qui restent','Voisins invisibles','Hors cadre','L\'Autre cÃ´tÃ©',
    'Portes closes','Murs porteurs','Les OubliÃ©s','Entre les mailles',
    'Ã€ la marge','Sans adresse','Terres d\'accueil','Le Fil rouge',
    'Lignes de faille','En premiÃ¨re ligne','Angle mort','Zone grise',
    'Les Invisibles','Jeux de miroirs','Au bout du fil','Hors-jeu'
  ],
  alimentation: [
    'Ã€ table !','Faim de mois','Les AffamÃ©s','Pain perdu',
    'GoÃ»t amer','Table rase','La Part du gÃ¢teau','Miettes',
    'Le Ventre vide','Bon appÃ©tit !','Ã€ la bonne franquette','Plat du jour',
    'Digestion difficile','Cuisine interne','Menu fretin','RÃ©gime sec',
    'Faux filet','L\'Assiette vide','Sur le pouce','AppÃ©tit de vivre'
  ],
  santÃ©: [
    'Maux croisÃ©s','Crise de nerfs','Sous perfusion','Ã€ bout de souffle',
    'Hors d\'haleine','Effets secondaires','Chambre blanche','Dose maximale',
    'Le Mal du siÃ¨cle','Pression artÃ©rielle','Diagnostic vital','Sans ordonnance',
    'ThÃ©rapie de choc','En rÃ©mission','FiÃ¨vre','Cicatrices',
    'Blouses blanches','Au bord de la rupture','Point de suture','Rechute'
  ],
  justice: [
    'Verdict suspendu','Peines perdues','Justice aveugle','Hors la loi',
    'Le Dernier mot','Dossier classÃ©','Prisons dorÃ©es','Libre sous caution',
    'Le Poids de la preuve','Ã€ huis clos','Droits de l\'homme','ProcÃ¨s d\'intention',
    'En sursis','Bavure','Acquittement','Non-lieu',
    'Vice de procÃ©dure','PiÃ¨ces Ã  conviction','Mis en examen','Cellule de crise'
  ],
  mÃ©dias: [
    'Hors antenne','Fake it','En direct','Sous Ã©coute',
    'Signal faible','Ã‰cran total','La Fabrique du clic','Bruit de fond',
    'Hors champ','Off the record','DerriÃ¨re l\'Ã©cran','Mise au point',
    'Flash info','Le Petit Ã©cran','Scroll infini','Double exposition',
    'Point de vue','Zone de flou','En sourdine','PremiÃ¨re page'
  ],
  culture: [
    'Contrepoint','Les Coulisses','Acte final','En scÃ¨ne',
    'Hors cadre','Faux-semblants','Ton sur ton','Cadence',
    'Crescendo','Le Dernier acte','Rideau rouge','Tempo',
    'Partition','L\'Envers du dÃ©cor','En coulisses','IntermÃ¨de',
    'Rappel','Harmoniques','Sous les projecteurs','Champ libre'
  ],
  Ã©ducation: [
    'Journal des classes','Copies blanches','Hors les murs','La Cour des grands',
    'Cours magistral','Entre les lignes','LeÃ§on de choses','Mauvais Ã©lÃ¨ves',
    'Bulletin de notes','Redoublement','La Sonnerie','RÃ©crÃ©ation permanente',
    'Salle d\'examen','Orientation forcÃ©e','Banc d\'essai','L\'Amphi vide',
    'RentrÃ©e des classes','L\'Ã‰preuve','En retenue','Moyenne gÃ©nÃ©rale'
  ],
  sport: [
    'Pressing constant','Hors-jeu','Temps mort','Carton rouge',
    'Prolongations','ArrÃªt de jeu','Ligne de touche','Sur le banc',
    'Coup franc','La RemontÃ©e','Match retour','Terrain glissant',
    'Au pied du mur','Score final','Hors course','Les RemplaÃ§ants',
    'Vestiaires','AprÃ¨s le coup de sifflet','Droit au but','Mi-temps'
  ],
  technologie: [
    'Ctrl+Z','Bug systÃ¨me','Hors connexion','En mode avion',
    'Crash test','Algorithme fatal','Data limite','Le Code source',
    'DÃ©connectÃ©s','Interface','Mises Ã  jour','Page not found',
    'En veille','DÃ©faut de fabrication','Obsolescence','Circuit fermÃ©',
    'Reboot','Sans fil','Ã‰cran noir','Format inconnu'
  ],
  politique: [
    'L\'Urne vide','Jeu de pouvoir','Lignes de partis','Gauche-droite',
    'En campagne','Vote blanc','Sous couvert','Main invisible',
    'Couloirs du pouvoir','L\'Opposition','Session plÃ©niÃ¨re','Off the record',
    'DÃ©mocratie en veille','Le Banc des accusÃ©s','Question de confiance','MajoritÃ© silencieuse',
    'Le CinquiÃ¨me pouvoir','Motion de censure','Sans Ã©tiquette','Petit arrangement'
  ],
  genre: [
    'Ã€ contre-cÅ“ur','Les Non-dites','Tabou','Double standard',
    'Corps Ã  corps','Ligne rouge','Consentement','Zones d\'ombre',
    'Le Silence des unes','Intime conviction','Mots couverts','Jeux de rÃ´les',
    'Sous le tapis','Permission accordÃ©e','Parole libÃ©rÃ©e','Le Plafond',
    'Dress code','Miroir dÃ©formant','En terrain intime','Rapport de force'
  ],
  international: [
    'Terre brÃ»lÃ©e','Ã‰chos lointains','Le Rideau de fer','Lignes de front',
    'Zone tampon','Les ExilÃ©s','Terre d\'asile','Passage interdit',
    'FrontiÃ¨res invisibles','Le Dernier refuge','En territoire inconnu','Sous les bombes',
    'Les DÃ©racinÃ©s','Ceux d\'en face','Le Camp','Retour au pays',
    'Lettre de l\'Ã©tranger','La Ligne verte','Diplomatie de l\'ombre','Pas de cÃ´tÃ©'
  ],
  Ã©conomie: [
    'Le Prix Ã  payer','Compte Ã  rebours','Main-d\'Å“uvre','Ã€ crÃ©dit',
    'Le Grand fossÃ©','Taux d\'usure','Heure supplÃ©mentaire','Fin de mois',
    'Le Petit commerce','Valeur ajoutÃ©e','Sans filet','Cadence infernale',
    'Le Juste prix','MarchÃ© noir','Liquidation','Fonds perdus',
    'En faillite','La Note','Sous le comptoir','Dividendes'
  ],
  urbanisme: [
    'BÃ©ton brut','Les Murs parlent','Hors zone','Plan B',
    'DerniÃ¨re station','Impasse','Sens interdit','Voie sans issue',
    'La Ligne 3','Les Passagers','Terminus','Bitume',
    'Place publique','Au coin de la rue','Bruit de ville','Zone blanche',
    'Cul-de-sac','Haut dÃ©bit','Sous le pont','Droit de passage'
  ]
};

// Universal/fallback names that work for any topic
const UNIVERSAL = [
  'Point de rupture','Zone d\'ombre','Hors radar','L\'Angle mort',
  'En surface','Sans filet','Le Fil rouge','Double fond',
  'Faux dÃ©part','Ligne de crÃªte','Entre deux feux','Signal d\'alarme',
  'En suspens','Face cachÃ©e','DÃ©calage','Le Non-dit',
  'Sous la surface','Champ de vision','Contrechamp','Ã‰tat des lieux'
];

function extractKeywords(text) {
  const normalized = text.toLowerCase()
    .normalize('NFD').replace(/[\u0300-\u036f]/g, '') // remove accents for matching
    .replace(/[^a-zÃ Ã¢Ã¤Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Ã¿Ã§Å“Ã¦\s-]/gi, ' ');

  const origWords = text.toLowerCase()
    .replace(/[^a-zÃ Ã¢Ã¤Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Ã¿Ã§Å“Ã¦\s-]/gi, ' ')
    .split(/\s+/)
    .filter(w => w.length > 2);

  return origWords.filter(w => {
    const clean = w.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
    return !STOP_WORDS.has(clean) && clean.length > 2;
  });
}

function detectThemes(keywords) {
  const scores = {};
  const normalizedKw = keywords.map(k => k.normalize('NFD').replace(/[\u0300-\u036f]/g, ''));

  for (const [theme, themeWords] of Object.entries(THEMES)) {
    const normalizedTW = themeWords.map(t => t.normalize('NFD').replace(/[\u0300-\u036f]/g, ''));
    let score = 0;
    for (const kw of normalizedKw) {
      for (const tw of normalizedTW) {
        if (kw.includes(tw) || tw.includes(kw)) score++;
      }
    }
    if (score > 0) scores[theme] = score;
  }

  return Object.entries(scores)
    .sort((a, b) => b[1] - a[1])
    .slice(0, 3)
    .map(e => e[0]);
}

function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function generateNames(description) {
  const keywords = extractKeywords(description);
  const themes = detectThemes(keywords);
  const candidates = new Set();

  // 1. Add themed expression twists (main source â€” IHECS style)
  for (const theme of themes) {
    const names = EXPRESSION_TWISTS[theme] || [];
    shuffle(names).slice(0, 6).forEach(n => candidates.add(n));
  }

  // 2. Add template-based names using keywords
  const templated = shuffle(getTemplates(keywords));
  templated.slice(0, 6).forEach(n => candidates.add(n));

  // 3. Fill with universal names if needed
  if (candidates.size < 8) {
    shuffle(UNIVERSAL).forEach(n => {
      if (candidates.size < 12) candidates.add(n);
    });
  }

  // If no theme detected, use more universals + templates
  if (themes.length === 0) {
    shuffle(UNIVERSAL).forEach(n => candidates.add(n));
    // Add a random theme for variety
    const randomTheme = shuffle(Object.keys(EXPRESSION_TWISTS))[0];
    shuffle(EXPRESSION_TWISTS[randomTheme]).slice(0, 4).forEach(n => candidates.add(n));
  }

  // Return exactly 8 unique names
  return shuffle([...candidates]).slice(0, 8);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// WHEEL RENDERING & ANIMATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const WHEEL_COLORS = [
  '#CC1122', '#1a1a2e', '#2b2d42', '#0f3460',
  '#533483', '#16213e', '#8b1a1a', '#2a2a3e'
];

let currentNames = [];
let wheelAngle = 0;
let spinning = false;
let wheelAnimId = null;

function drawWheel(names, angle) {
  const canvas = document.getElementById('wheel');
  const ctx = canvas.getContext('2d');
  const size = canvas.width;
  const cx = size / 2, cy = size / 2, r = size / 2 - 10;
  const segAngle = (2 * Math.PI) / names.length;

  ctx.clearRect(0, 0, size, size);

  // Draw segments
  names.forEach((name, i) => {
    const startA = angle + i * segAngle;
    const endA = startA + segAngle;

    // Segment fill
    ctx.beginPath();
    ctx.moveTo(cx, cy);
    ctx.arc(cx, cy, r, startA, endA);
    ctx.closePath();
    ctx.fillStyle = WHEEL_COLORS[i % WHEEL_COLORS.length];
    ctx.fill();

    // Segment border
    ctx.strokeStyle = 'rgba(255,255,255,0.08)';
    ctx.lineWidth = 2;
    ctx.stroke();

    // Text
    ctx.save();
    ctx.translate(cx, cy);
    ctx.rotate(startA + segAngle / 2);
    ctx.textAlign = 'right';
    ctx.textBaseline = 'middle';
    ctx.fillStyle = '#ffffff';

    // Fit text
    let fontSize = 28;
    ctx.font = `bold ${fontSize}px "Barlow Condensed", sans-serif`;
    while (ctx.measureText(name).width > r - 80 && fontSize > 14) {
      fontSize -= 2;
      ctx.font = `bold ${fontSize}px "Barlow Condensed", sans-serif`;
    }
    ctx.fillText(name, r - 30, 0);
    ctx.restore();
  });

  // Center circle
  ctx.beginPath();
  ctx.arc(cx, cy, 44, 0, 2 * Math.PI);
  ctx.fillStyle = '#0d0d0d';
  ctx.fill();
  ctx.strokeStyle = '#CC1122';
  ctx.lineWidth = 4;
  ctx.stroke();

  // Center dot
  ctx.beginPath();
  ctx.arc(cx, cy, 8, 0, 2 * Math.PI);
  ctx.fillStyle = '#CC1122';
  ctx.fill();
}

function getWinnerIndex(names, angle) {
  const segAngle = (2 * Math.PI) / names.length;
  // The pointer is at the top (angle = -PI/2 or 3PI/2)
  const pointerAngle = -Math.PI / 2;
  // Normalize angle
  let normalizedPointer = (pointerAngle - angle) % (2 * Math.PI);
  if (normalizedPointer < 0) normalizedPointer += 2 * Math.PI;
  return Math.floor(normalizedPointer / segAngle) % names.length;
}

function spinWheel() {
  if (spinning || currentNames.length === 0) return;
  spinning = true;

  document.getElementById('btn-spin').disabled = true;
  document.getElementById('result-section').classList.remove('visible');

  // Random spin: 4-8 full rotations + random offset
  const totalRotation = (4 + Math.random() * 4) * 2 * Math.PI + Math.random() * 2 * Math.PI;
  const startAngle = wheelAngle;
  const targetAngle = startAngle + totalRotation;
  const duration = 4000 + Math.random() * 2000; // 4-6 seconds
  const startTime = performance.now();

  function animate(now) {
    const elapsed = now - startTime;
    const progress = Math.min(elapsed / duration, 1);

    // Cubic ease-out for natural deceleration
    const eased = 1 - Math.pow(1 - progress, 3);
    wheelAngle = startAngle + totalRotation * eased;

    drawWheel(currentNames, wheelAngle);

    if (progress < 1) {
      wheelAnimId = requestAnimationFrame(animate);
    } else {
      spinning = false;
      document.getElementById('btn-spin').disabled = false;

      // Show result
      const winnerIdx = getWinnerIndex(currentNames, wheelAngle);
      const winnerName = currentNames[winnerIdx];
      showResult(winnerName);
    }
  }

  wheelAnimId = requestAnimationFrame(animate);
}

function showResult(name) {
  const section = document.getElementById('result-section');
  const nameEl = document.getElementById('result-name');
  nameEl.textContent = name;
  section.classList.add('visible');

  // Remove and re-add animation class
  nameEl.style.animation = 'none';
  nameEl.offsetHeight; // trigger reflow
  nameEl.style.animation = '';

  // Highlight in all-names list
  document.querySelectorAll('.name-chip').forEach(chip => {
    chip.classList.toggle('winner', chip.textContent === name);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MAIN FLOW
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function generate() {
  const desc = document.getElementById('description').value.trim();
  if (!desc) {
    document.getElementById('description').focus();
    return;
  }

  // Generate names
  currentNames = generateNames(desc);

  // Show wheel
  const wheelSection = document.getElementById('wheel-section');
  wheelSection.classList.add('visible');

  // Reset
  wheelAngle = Math.random() * 2 * Math.PI;
  drawWheel(currentNames, wheelAngle);

  // Show all names list
  const allNames = document.getElementById('all-names');
  const list = document.getElementById('all-names-list');
  list.innerHTML = currentNames.map(n =>
    `<div class="name-chip" onclick="selectName(this, '${n.replace(/'/g, "\\'")}')">${n}</div>`
  ).join('');
  allNames.classList.add('visible');

  // Hide result
  document.getElementById('result-section').classList.remove('visible');

  // Scroll to wheel
  wheelSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function selectName(chip, name) {
  showResult(name);
  document.getElementById('result-section').scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function copyName() {
  const name = document.getElementById('result-name').textContent;
  navigator.clipboard.writeText(name).then(() => {
    const btn = document.querySelector('.result-actions .btn-action');
    const original = btn.textContent;
    btn.textContent = 'âœ“ CopiÃ© !';
    setTimeout(() => btn.textContent = original, 1500);
  });
}
</script>
</body>
</html>
